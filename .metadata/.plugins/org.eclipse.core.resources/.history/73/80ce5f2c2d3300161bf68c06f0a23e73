package ru.game.client;
import org.eclipse.swt.SWT;
import org.eclipse.swt.widgets.Menu;
import org.eclipse.swt.widgets.MenuItem;

public class TetrisMenu 
{
	private static TetrisCanvas tetris;
	public static TetrisGame shell;

	public TetrisMenu(TetrisGame shell) 
	{
		createMenu(shell, tetris);
	}
	
	public void createMenu(TetrisGame shell, TetrisCanvas tetris)
	{
		Menu menuBar = new Menu(shell, SWT.BAR);// создаем панельку для меню
		MenuItem cascadeFileMenu = new MenuItem(menuBar, SWT.CASCADE);// создаем пункты меню на верхней панели
		MenuItem cascadeViewMenu = new MenuItem(menuBar, SWT.CASCADE);
		MenuItem cascadeHelpMenu = new MenuItem(menuBar, SWT.CASCADE);
	    cascadeFileMenu.setText("&Файл");
	    cascadeViewMenu.setText("&Вид");
	    cascadeHelpMenu.setText("&Справка");
	    
	    Menu fileMenu = new Menu(shell, SWT.DROP_DOWN);// делаем выпадающие менюшки
	    Menu viewMenu = new Menu(shell, SWT.DROP_DOWN);
	    Menu helpMenu = new Menu(shell, SWT.DROP_DOWN);
	    cascadeFileMenu.setMenu(fileMenu);// прикрепляем к кнопкам на панели
	    cascadeViewMenu.setMenu(viewMenu);
	    cascadeHelpMenu.setMenu(helpMenu);
	    // файл
	    MenuItem newGameItem = new MenuItem(fileMenu, SWT.PUSH);// делаем пункты выпадающих меню
	    MenuItem joinGameItem = new MenuItem(fileMenu, SWT.PUSH);
	    MenuItem statItem = new MenuItem(fileMenu, SWT.PUSH);
	    MenuItem exitItem = new MenuItem(fileMenu, SWT.PUSH);
	    newGameItem.setText("&Новая игра");
	    joinGameItem.setText("&Присоединиться к игре");
	    statItem.setText("&Статистика");
	    exitItem.setText("&Выход");
	    
	    // вид
	    MenuItem themecolorItem = new MenuItem(viewMenu, SWT.CASCADE);
	    themecolorItem.setText("&Сетка");
	    Menu selectionMenu = new Menu(shell, SWT.DROP_DOWN);// делаем подменю с выбором "темы"
	    themecolorItem.setMenu(selectionMenu);
	    
	    MenuItem visibleGridItem = new MenuItem(selectionMenu, SWT.PUSH);
	    visibleGridItem.setText("&Показать");
	    MenuItem invisibleGridItem = new MenuItem(selectionMenu, SWT.PUSH);
	    invisibleGridItem.setText("&Скрыть");
	    
	   	// справка    
	    MenuItem helpItem = new MenuItem(helpMenu, SWT.PUSH);
	    MenuItem infoItem = new MenuItem(helpMenu, SWT.PUSH);
	    helpItem.setText("&Просмотреть справку");
	    infoItem.setText("&О программе");
	   
	    shell.setMenuBar(menuBar);// прикрепили меню к окну
	    
	    // обработка действий,связанных с меню
	    
	    newGameItem.addListener(SWT.Selection, event-> 
	    	{
	    		try {
					tetris.drawWaiting();
				} catch (Exception e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}	
	    	}
	    );
	    
	    joinGameItem.addListener(SWT.Selection, event-> 
    		{
    			try {
					tetris.joinGame();
				} catch (Exception e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}	
    		}
	    );
	    
	   	exitItem.addListener(SWT.Selection, event-> 
	   	   	{
	   	    	shell.getDisplay().dispose();
	   	    	System.exit(0);
	   	    }
	   	);
	   	    
	   	visibleGridItem.addListener(SWT.Selection, event-> 
	   		{
	   			tetris.isGridEnabled(true);
		    }
	   	);
	   	 
	   	invisibleGridItem.addListener(SWT.Selection, event-> 
	   		{
	   	    	tetris.isGridEnabled(false);
		    }
	   	);
	}
}